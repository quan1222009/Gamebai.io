<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Card Game</title>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
<h1>Card Game Prototype</h1>

<div>
  <h3>Auth</h3>
  <input id="username" placeholder="Username">
  <input id="password" type="password" placeholder="Password">
  <button onclick="register()">Register</button>
  <button onclick="login()">Login</button>
</div>

<div>
  <h3>Room</h3>
  <button onclick="createRoom()">Create Room</button>
  <input id="joinRoomID" placeholder="Room ID">
  <button onclick="joinRoom()">Join Room</button>
</div>

<script>
let socket;

async function register(){
  const username=document.getElementById("username").value;
  const password=document.getElementById("password").value;
  const res=await fetch('/api/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})});
  const data=await res.json();
  alert(JSON.stringify(data));
}

async function login(){
  const username=document.getElementById("username").value;
  const password=document.getElementById("password").value;
  const res=await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})});
  const data=await res.json();
  alert(JSON.stringify(data));
  if(data.token){
    socket=io();
  }
}

async function createRoom(){
  const username=document.getElementById("username").value;
  const res=await fetch('/api/room/create',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({gameType:"sam",userID:username})});
  const data=await res.json();
  alert(JSON.stringify(data));
}

async function joinRoom(){
  const roomID=document.getElementById("joinRoomID").value;
  const username=document.getElementById("username").value;
  const res=await fetch('/api/room/join',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({roomID,userID:username})});
  const data=await res.json();
  alert(JSON.stringify(data));
}
</script>
</body>
</html>
